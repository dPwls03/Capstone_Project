# âœ… 6ì£¼ì°¨: í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¶• ë° ê°œë°œ

## Next.js & pnpm ì„¤ì¹˜ ë° í”„ë¡œì íŠ¸ ì‹¤í–‰

> ðŸ”— ì°¸ê³  ìžë£Œ  
- [next.js](https://nextjs.org/) 
- [pnpm](https://pnpm.io/ko/installation)

> Frontend Next.js ìƒˆ í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°

```bash
npx create-next-app@latest
```

> pnpm ì„¤ì¹˜í•˜ê¸°

```bash
npm install -g pnpm@latest-10
```

> í”„ë¡œì íŠ¸ ì„œë²„ ì‹¤í–‰

```bash
npm run dev
```

## í™”ìž¬ ê°ì§€ í”„ë¡ íŠ¸ì—”ë“œ êµ¬ì¶•

> ðŸ”— ì°¸ê³  ìžë£Œ
- [TanStack Query](https://tanstack.com/query/latest/docs/framework/react/installation)

> TanStack Query ì„¤ì¹˜í•˜ê¸°

```bash
pnpm add @tanstack/react-query
```

> Provider.tsx íŒŒì¼ ìƒì„±

```bash
'use client'

import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import { useState } from 'react'

export default function Providers({ children }: { children: React.ReactNode }) {
    const [queryClient] = useState(() => new QueryClient())

    return (
        <QueryClientProvider client={queryClient}>
            {children}
        </QueryClientProvider>
    )
}
```

> layout.tsx ìˆ˜ì •

```bash
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";
import Providers from "./providers";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {


  return (
    <html lang="en">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        <Providers>
          {children}
        </Providers>
      </body>
    </html>
  );
}
```

> í”„ë¡œì íŠ¸ ì‹¤í–‰

```bash
pnpm run dev
```

## ì‹¤ì‹œê°„ í™”ìž¬ ê°ì§€ë¥¼ ìœ„í•œ ì˜¤ë””ì˜¤ ë° ê²½ê³  ì‹œìŠ¤í…œ êµ¬í˜„

> í™”ìž¬ ê°ì§€ ì‹œ ì•ŒëžŒ, ë°°ê²½ íš¨ê³¼ì£¼ê¸°

tailwind.config.ts

```bash
import type { Config } from "tailwindcss";

export default {
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      colors: {
        background: "var(--background)",
        foreground: "var(--foreground)",
      },
      keyframes: {
        slideIn: {
          from: { transform: 'translateX(100%)', opacity: '0' },
          to: { transform: 'translateX(0)', opacity: '1' },
        },
        slideOut: {
          from: { transform: 'translateX(0)', opacity: '1' },
          to: { transform: 'translateX(100%)', opacity: '0' },
        },
        pulse: {
          '0%, 100%': { backgroundColor: 'rgba(239, 68, 68, 0.9)' },
          '50%': { backgroundColor: 'rgba(220, 38, 38, 0.9)' },
        },
        flashBorder: {
          '0%, 100%': { 
            boxShadow: '0 0 0 0 rgba(239, 68, 68, 0)' 
          },
          '50%': { 
            boxShadow: '0 0 0 6px rgba(239, 68, 68, 0.5)' 
          }
        },
        screenFlash: {
          '0%, 100%': { 
            boxShadow: 'inset 0 0 0 0 rgba(239, 68, 68, 0)' 
          },
          '50%': { 
            boxShadow: 'inset 0 0 100px 0 rgba(239, 68, 68, 0.3)' 
          }
        }
      },
      animation: {
        slideIn: 'slideIn 0.5s ease-out forwards',
        slideOut: 'slideOut 0.5s ease-out forwards',
        pulse: 'pulse 2s ease-in-out infinite',
        flashBorder: 'flashBorder 2s ease-in-out infinite',
        screenFlash: 'screenFlash 2s ease-in-out infinite'
      },
    },
  },
  plugins: [],
} satisfies Config;
```

> ì˜¤ë””ì˜¤ ê¶Œí•œ, ê²½ê³ ìŒ ìƒì„± ë° ìž¬ìƒ ì½”ë“œ

page.tsx

```bash
const initAudioContext = async () => {
    try {
      if (!audioPermission) {
        const userConsent = window.confirm("í™”ìž¬ ê²½ë³´ì—ëŠ” ì˜¤ë””ì˜¤ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤. í—ˆìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
        if (!userConsent) {
          return false;
        }

        const AudioContext = window.AudioContext || (window as any).webkitAudioContext;
        audioContextRef.current = new AudioContext();

        // iOS Safari
        if (audioContextRef.current.state === 'suspended') {
          await audioContextRef.current.resume();
        }

        setAudioPermission(true);
        return true;
      }
      return true;
    } catch (error) {
      console.error("audio initialization error:", error);
      alert("audio initialization failed.");
      return false;
    }
  };

  // ê²½ê³ ìŒ ë©ˆì¶”ê¸°
  const stopAlertSound = () => {
    if (sourceNodeRef.current) {
        sourceNodeRef.current.stop();
        sourceNodeRef.current.disconnect();
    }
    if (gainNodeRef.current) {
        gainNodeRef.current.disconnect();
    }
  };

  // ê²½ê³ ìŒ ìƒì„± ë° ìž¬ìƒ
  const playAlertSound = () => {
    if (!audioContextRef.current) return;
    stopAlertSound();

    const oscillator = audioContextRef.current.createOscillator();
    gainNodeRef.current = audioContextRef.current.createGain();

    oscillator.type = 'sawtooth';
    oscillator.frequency.setValueAtTime(440, audioContextRef.current.currentTime);

    // frequency modulation
    oscillator.frequency.setValueAtTime(440, audioContextRef.current.currentTime);
    oscillator.frequency.linearRampToValueAtTime(880, audioContextRef.current.currentTime + 0.5);
    oscillator.frequency.linearRampToValueAtTime(440, audioContextRef.current.currentTime + 1);

    // volume adjustment
    gainNodeRef.current.gain.setValueAtTime(0.5, audioContextRef.current.currentTime);

    oscillator.connect(gainNodeRef.current);
    gainNodeRef.current.connect(audioContextRef.current.destination);

    oscillator.start();
    sourceNodeRef.current = oscillator; //OscillatorNodeë¡œ í• ë‹¹
  };
```

## í™”ìž¬ ê°ì§€ ë¡œê·¸ì˜ ë°˜ì‘í˜• ì›¹ êµ¬í˜„

> ê°ì§€ ë¡œê·¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°

detectionLogs/page.tsx

```bash
  const getDetectionLogs = async ({
    page,
    pageSize,
  }: {
    page: number
    pageSize: number
  }) => {
    const response = await fetch(
      `http://localhost:8000/get_detection_log?page=${page}&page_size=${pageSize}`,
    )
    return response.json()
  }

  const { data: getDetectionLogsData } = useQuery({
    queryKey: ['get_detection_log', page, pageSize],
    queryFn: () => getDetectionLogs({ page, pageSize }),
  })
```
